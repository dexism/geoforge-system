<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <title>GeoForge System - World Map</title>
    <link rel="stylesheet" href="style.css">
    <!-- フォント読み込み -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <!-- アイコンフォント -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
</head>

<body>
    <script src="//accaii.com/geoforge/script.js" async></script><noscript><img
            src="//accaii.com/geoforge/script?guid=on"></noscript>
    <div id="loading-overlay">
        <div class="loading-content">
            <h1 id="loading-title">GeoForge SYSTEM v2.5.20<br>世界を創造しています！</h1>
            <div id="progress-bar-container" class="progress-bar-container" style="display: none;">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
            <div id="loading-log"></div>
        </div>
    </div>

    <input type="checkbox" id="menu-toggle" class="menu-toggle-checkbox">
    <label for="menu-toggle" class="menu-toggle-label">
        <span></span>
    </label>

    <div class="container">
        <aside class="sidebar">
            <details id="overall-info-container" open>
                <summary>全体情報</summary>
                <div id="info-global-stats">
                    <div class="info-line">
                        <span>総人口</span>
                        <span id="info-total-population">---</span>
                    </div>
                    <div class="info-line">
                        <span>国家数</span>
                        <span id="info-nation-count">---</span>
                    </div>
                    <div id="info-settlement-summary" class="info-line">
                        <!-- ここに集落概要が入る -->
                    </div>
                </div>
                <!-- 国家ごとの詳細情報がここに入る -->
                <div id="info-nations-details"></div>
            </details>
            <h3>表示切替</h3>

            <!-- 1. 基本地図 (択一) -->
            <details open>
                <summary>基本地図</summary>
                <div class="map-type-selector">
                    <input type="radio" id="map-type-terrain" name="map-type" value="terrain" checked>
                    <label for="map-type-terrain">地形図</label>
                    <input type="radio" id="map-type-white" name="map-type" value="white">
                    <label for="map-type-white">白地図</label>
                </div>
            </details>

            <!-- 2. レイヤー (重ねがけ) -->
            <details open>
                <summary>レイヤー</summary>
                <ul>
                    <li><button id="toggleVegetationLayer" class="active">植生</button></li>
                    <li><button id="toggleReliefLayer" class="active">レリーフ</button></li>
                    <li><button id="toggleContourLayer" class="active">等高線</button></li>
                    <li><button id="toggleSettlementLayer" class="active">集落・国境</button></li>
                    <li><button id="toggleRoadLayer" class="active">道路網</button></li>
                    <li><button id="toggleTerritoryLayer">領地</button></li>
                    <li><button id="toggleRidgeWaterSystemLayer">稜線水系図</button></li>
                    <li><button id="toggleHexBorderLayer" class="active">ヘックス境界</button></li>
                </ul>
            </details>

            <!-- 3. 地理情報 -->
            <details>
                <summary>地理情報</summary>
                <ul>
                    <li><button id="toggleTempLayer">気温</button></li>
                    <li><button id="togglePrecipLayer">降水量</button></li>
                    <li><button id="toggleClimateZoneLayer">気候帯</button></li>
                    <li><button id="togglePopulationLayer">人口分布</button></li>
                    <li><button id="toggleMonsterLayer">魔物分布</button></li>
                </ul>
            </details>

            <!-- 4. 資源 -->
            <details>
                <summary>資源</summary>
                <ul>
                    <li><button id="toggleManaLayer">魔力 (龍脈)</button></li>
                    <li><button id="toggleAgriLayer">農業適性</button></li>
                    <li><button id="toggleForestLayer">林業適性</button></li>
                    <li><button id="toggleMiningLayer">鉱業適性</button></li>
                    <li><button id="toggleFishingLayer">漁業適性</button></li>
                    <li><button id="toggleHuntingLayer">狩猟適性</button></li>
                    <li><button id="togglePastoralLayer">牧畜適性</button></li>
                    <li><button id="toggleLivestockLayer">家畜適性</button></li>
                </ul>
                <p class="note">※酪農は現在未実装です。</p>
            </details>

            <div id="legend-container" class="legend-container"></div>

            <details>
                <summary>システム</summary>
                <ul>
                    <li><button id="force-regenerate-btn">強制再生成</button></li>
                </ul>
                <div class="generation-controls">
                    <p class="note">ステップごとに世界を生成します。<br>各ステップで再生成が可能です。</p>
                    <ul>
                        <li><button id="step1-continent-btn">① 大陸・河川生成</button></li>
                        <li><button id="step2-climate-btn" disabled>② 気候・植生生成</button></li>
                        <li><button id="step3-settlement-btn" disabled>③ 集落生成</button></li>
                        <li><button id="step4-nation-btn" disabled>④ 道路・国家生成</button></li>
                        <li><button id="step5-save-btn" disabled>⑤ 保存（GAS）</button></li>
                        <li><button id="download-json-btn" disabled>⑥ JSONダウンロード</button></li>
                        <li><button id="load-gas-btn">⑦ GASからロード</button></li>
                    </ul>
                </div>
            </details>

            <p>&copy; 2025 Candle's. All rights reserved.</p>
        </aside>

        <main class="main-content">
            <svg id="hexmap"></svg>
        </main>
    </div>

    <div id="info-window" class="hidden">
        <div id="info-window-content">
        </div>
        <button id="info-close-btn" class="material-icons-round" title="閉じる">close</button>
    </div>

    <script type="module" src="./main.js"></script>
</body>

</html>